<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Room Listings</title>
  <meta content="" name="description">
  <meta content="" name="keywords">


  <%- include('./partials/bootstrap_link.ejs')%>


    <!-- Template Main CSS File -->
    <link href="/css/roompage.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">


    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
      crossorigin="anonymous"></script>

</head>

<body>

  <!-- Header Section  -->
  <%- include('./partials/header.ejs')%>

    <section class="portfolio" id="portfolio">

      <div class="container text-center">
        <h2>
          Indore's Prime Locations
        </h2>

        <p style="color: white;">
          Voluptua scripserit per ad, laudem viderer sit ex. Ex alia corrumpit voluptatibus usu, sed unum convenire id.
          Ut cum nisl moderatius, Per nihil dicant commodo an.
        </p>
      </div>
      </div>
    </section><!-- End Portfolio Section -->

    <!-- ======================================================(Filters)================================================================ -->


    <!-- ======= Team Section ======= -->
    <section id="team" class="team">
      <div class="container">

        <div class="section-title">
          <h2>Search Your Future Roomi</h2>
        </div>

        <div class="row">
          <%needHouseList.forEach((data,index)=>{%>

            <div class="col-lg-6">
              <div class="member d-flex align-items-start">
                <div class="pic">
                  <%lister.forEach(detail=>{%>
                    <%if(data.userEmail==detail.email){%>
                      <img src="uploads/<%=detail.profileImg %>" class="img-fluid" alt="...">
                      <%}})%>

                </div>
                <div class="member-info">
                  <h4>
                    <%lister.forEach(detail=>{%>
                      <%if(data.userEmail==detail.email){%>
                        <%=detail.name%>
                          <%}})%>
                  </h4>
                  <span><i class="bi bi-geo-alt-fill"></i>
                    <%= data.houseArea%>
                  </span>
                  <span><i class="bi bi-currency-rupee"></i>
                    <%= data.houseRent%>
                  </span>
                  <span><i class="bi bi-people-fill"></i>
                    <%= data.houseOccupany%>
                  </span>
                  <p>
                    <%=data.roomtype%>
                  </p>
                  <div class="social">
                    <p>Looking for <%= data.gender%>
                    </p>
                  </div>

                  <!-- Button trigger modal -->

                  <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                    data-bs-target="#staticBackdrop<%=index%>">
                    View <%lister.forEach(detail=>{%>
                      <%if(data.userEmail==detail.email){%>
                        <%=detail.name%>
                          <%}})%>
                  </button>
                </div>
              </div>



              <!-- Modal -->
              <div class="modal fade" id="staticBackdrop<%=index%>" data-bs-backdrop="static" data-bs-keyboard="false"
                tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h3>
                        <font style="color:rgb(8, 249, 241)">Dekh</font>Mate
                      </h3>
                    </div>
                    <div class="row">
                      <div class=" col-sm-6 col-lg-4">

                        <%lister.forEach(detail=>{%>
                          <%if(detail.email===data.userEmail){%>
                            <img src="uploads/<%=detail.profileImg %>"
                              style="height:150px; width: 150px; border-radius: 50%;" class="img-fluid" alt="...">
                            <%}})%>
                      </div>


                      <div class="col-lg-8" id="roomD1">
                        <br>
                        <ul>
                          <li><span> <b>Name - </b></span><span>
                              <%lister.forEach(detail=>{%>
                                <%if(data.userEmail==detail.email){%>
                                   <%=detail.name%>
                                    <%}})%>
                            </span><i class="glyphicon glyphicon-envelope"></i></li>
                          <li><span><b>Email - </b></span><span>
                              <%= data.userEmail%>
                            </span></li>
                          <li><span><b>Contact - </b></span><span>
                              <%= data.Contact%>
                            </span></li>
                        </ul>
                      </div>
                    </div>

                          <!-- Matching Box -->
                    <!-- ============================================================ -->

                    <div class="container" >
                      <div class="circular-progress" >
                        <% var count=0; %> 
                        <% lister.forEach(detail => { %>
                          <% if (data.userEmail==detail.email) { %>
                            <% for( let index = 0; index < detail.personQlt.length; index++ ) { %>
                              <% for( let i = 0; i < user.personQlt.length; i++ ) { %>
                                <% if (detail.personQlt[index]==user.personQlt[i]) { %>
                                  <%count+=20%> 
                                <% } %>
                              <% } %>
                            <% } %>
                          <% } %>
                        <% }) %>
                        <span class="progress-value" id="staticBackdrop<%=index%>"><%=count%> %</span>
                      </div>
                      <span class="text">Matching Rate</span>                    
                    </div>

                    <!-- ============================================================ -->

                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">Send Request Message</h5>
                    </div>
                    <div class="modal-body">
                      <form method="post">
                        <div class="mb-3">
                          <label for="recipient-name" class="col-form-label">Recipient:</label>
                          <input type="text" class="form-control" name="reciver" id="recipient-name" value="<%= data.userEmail%>"
                            readonly>
                        </div>
                        <div class="mb-3">
                          <label for="message-text" class="col-form-label">Message:</label>
                          <textarea class="form-control" id="message-text" name="message"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary" onsubmit="SendRequest" name="sender">Send message</button>
                      </form>
                    </div>
                    <div class="modal-footer">
                      <button type="submit" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <%})%>
        </div>
      </div>
    </section><!-- End Team Section -->
    <%- include('./partials/_footer.ejs')%>

      <div id="preloader"></div>
      <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
          class="bi bi-arrow-up-short"></i></a>

      <%- include('./partials/_script.ejs')%>

</body>
    <script>
      
        // let circularProgress = document.querySelector(".circular-progress"),
        // progressValue = document.querySelector(".progress-value");
        // let progressStartValue = 10,    
        // progressEndValue = 70,    
        // speed = 25;

        // let progress = setInterval(() => {
        // progressStartValue++;

        // progressValue.textContent = `${progressStartValue}%`
        // circularProgress.style.background = `conic-gradient(#7d2ae8 ${progressStartValue * 3.6}deg, #ededed 0deg)`

        // if(progressStartValue == progressEndValue){
        //     clearInterval(progress);
        // }    
        // }, speed);
          let circularProgress = document.querySelector(".circular-progress"),
        progressValue = document.querySelector(".progress-value");
        let progressStartValue = 10,    
        progressEndValue = 70,    
        speed = 25;

        let progress = setInterval(() => {
        progressStartValue++;

        progressValue.textContent = `${progressStartValue}%`
        circularProgress.style.background = `conic-gradient(#7d2ae8 ${progressStartValue * 3.6}deg, #ededed 0deg)`

        if(progressStartValue == progressEndValue){
            clearInterval(progress);
        }    
        }, speed)


    </script>

</html>